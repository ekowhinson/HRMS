# Generated by Django 6.0.1 on 2026-02-06 11:16

import django.db.models.deletion
import uuid
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('recruitment', '0004_add_vacancy_url_system'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='ShortlistCriteria',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_deleted', models.BooleanField(db_index=True, default=False)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('criteria_type', models.CharField(choices=[('EDUCATION', 'Education Level'), ('EXPERIENCE', 'Years of Experience'), ('SKILL', 'Required Skill'), ('QUALIFICATION', 'Professional Qualification'), ('AGE_RANGE', 'Age Range'), ('LOCATION', 'Location/Region'), ('CUSTOM', 'Custom Criteria')], max_length=20)),
                ('match_type', models.CharField(choices=[('EXACT', 'Exact Match'), ('MINIMUM', 'Minimum Requirement'), ('MAXIMUM', 'Maximum Allowed'), ('CONTAINS', 'Contains Keyword'), ('RANGE', 'Within Range')], default='MINIMUM', max_length=20)),
                ('name', models.CharField(max_length=200)),
                ('description', models.TextField(blank=True)),
                ('value_text', models.CharField(blank=True, max_length=500)),
                ('value_number', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('value_min', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('value_max', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('weight', models.DecimalField(decimal_places=2, default=1.0, help_text='Weight for scoring (1.0 = standard, higher = more important)', max_digits=5)),
                ('max_score', models.PositiveIntegerField(default=10, help_text='Maximum score for this criterion')),
                ('is_mandatory', models.BooleanField(default=False, help_text='If true, failing this criterion disqualifies applicant')),
                ('sort_order', models.PositiveIntegerField(default=0)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
                ('vacancy', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='shortlist_criteria', to='recruitment.vacancy')),
            ],
            options={
                'db_table': 'shortlist_criteria',
                'ordering': ['vacancy', 'sort_order'],
            },
        ),
        migrations.CreateModel(
            name='ShortlistRun',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_deleted', models.BooleanField(db_index=True, default=False)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('run_number', models.CharField(max_length=20)),
                ('run_date', models.DateTimeField(auto_now_add=True)),
                ('pass_score', models.DecimalField(decimal_places=2, default=60, help_text='Minimum score to be considered qualified', max_digits=5)),
                ('include_screening_score', models.BooleanField(default=True, help_text='Include manual screening score in final score')),
                ('screening_weight', models.DecimalField(decimal_places=2, default=0.3, help_text='Weight for screening score (0-1)', max_digits=5)),
                ('status', models.CharField(choices=[('PENDING', 'Pending'), ('PROCESSING', 'Processing'), ('COMPLETED', 'Completed'), ('FAILED', 'Failed')], default='PENDING', max_length=20)),
                ('total_applicants', models.PositiveIntegerField(default=0)),
                ('qualified_count', models.PositiveIntegerField(default=0)),
                ('disqualified_count', models.PositiveIntegerField(default=0)),
                ('notes', models.TextField(blank=True)),
                ('error_message', models.TextField(blank=True)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL)),
                ('run_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
                ('vacancy', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='shortlist_runs', to='recruitment.vacancy')),
            ],
            options={
                'db_table': 'shortlist_runs',
                'ordering': ['-run_date'],
            },
        ),
        migrations.CreateModel(
            name='ShortlistTemplate',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_deleted', models.BooleanField(db_index=True, default=False)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('code', models.CharField(max_length=20, unique=True)),
                ('name', models.CharField(max_length=200)),
                ('description', models.TextField(blank=True)),
                ('job_family', models.CharField(blank=True, help_text='Job family this template applies to (e.g., IT, Finance, Driver)', max_length=100)),
                ('is_active', models.BooleanField(default=True)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'shortlist_templates',
                'ordering': ['name'],
            },
        ),
        migrations.CreateModel(
            name='ShortlistTemplateCriteria',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_deleted', models.BooleanField(db_index=True, default=False)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('criteria_type', models.CharField(choices=[('EDUCATION', 'Education Level'), ('EXPERIENCE', 'Years of Experience'), ('SKILL', 'Required Skill'), ('QUALIFICATION', 'Professional Qualification'), ('AGE_RANGE', 'Age Range'), ('LOCATION', 'Location/Region'), ('CUSTOM', 'Custom Criteria')], max_length=20)),
                ('match_type', models.CharField(choices=[('EXACT', 'Exact Match'), ('MINIMUM', 'Minimum Requirement'), ('MAXIMUM', 'Maximum Allowed'), ('CONTAINS', 'Contains Keyword'), ('RANGE', 'Within Range')], default='MINIMUM', max_length=20)),
                ('name', models.CharField(max_length=200)),
                ('description', models.TextField(blank=True)),
                ('weight', models.DecimalField(decimal_places=2, default=1.0, max_digits=5)),
                ('max_score', models.PositiveIntegerField(default=10)),
                ('is_mandatory', models.BooleanField(default=False)),
                ('sort_order', models.PositiveIntegerField(default=0)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL)),
                ('template', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='criteria', to='recruitment.shortlisttemplate')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'shortlist_template_criteria',
                'ordering': ['template', 'sort_order'],
            },
        ),
        migrations.CreateModel(
            name='ShortlistResult',
            fields=[
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_deleted', models.BooleanField(db_index=True, default=False)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('criteria_score', models.DecimalField(decimal_places=2, default=0, help_text='Score from criteria matching', max_digits=7)),
                ('screening_score_used', models.DecimalField(decimal_places=2, default=0, help_text='Screening score factored in', max_digits=7)),
                ('final_score', models.DecimalField(decimal_places=2, default=0, help_text='Final weighted score', max_digits=7)),
                ('percentage_score', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('rank', models.PositiveIntegerField(blank=True, null=True)),
                ('outcome', models.CharField(choices=[('QUALIFIED', 'Qualified'), ('NOT_QUALIFIED', 'Not Qualified'), ('DISQUALIFIED', 'Disqualified (Mandatory Failed)'), ('MANUAL_REVIEW', 'Requires Manual Review')], default='MANUAL_REVIEW', max_length=20)),
                ('score_breakdown', models.JSONField(default=dict, help_text='Detailed breakdown of scores per criterion')),
                ('failed_mandatory', models.JSONField(default=list, help_text='List of mandatory criteria that failed')),
                ('notes', models.TextField(blank=True)),
                ('is_overridden', models.BooleanField(default=False)),
                ('override_outcome', models.CharField(blank=True, choices=[('QUALIFIED', 'Qualified'), ('NOT_QUALIFIED', 'Not Qualified'), ('DISQUALIFIED', 'Disqualified (Mandatory Failed)'), ('MANUAL_REVIEW', 'Requires Manual Review')], max_length=20)),
                ('override_reason', models.TextField(blank=True)),
                ('overridden_at', models.DateTimeField(blank=True, null=True)),
                ('applicant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='shortlist_results', to='recruitment.applicant')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_deleted', to=settings.AUTH_USER_MODEL)),
                ('overridden_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='shortlist_overrides', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
                ('shortlist_run', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='results', to='recruitment.shortlistrun')),
            ],
            options={
                'db_table': 'shortlist_results',
                'ordering': ['-final_score'],
                'unique_together': {('shortlist_run', 'applicant')},
            },
        ),
    ]
